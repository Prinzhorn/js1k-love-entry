<!doctype html>
<html>
	<head>
		<title>JS1k, 1k demo submission [ID]</title>
		<meta charset="utf-8" />
	</head>
	<body>
		<canvas id="c"></canvas>
		<script>
			var b = document.body;
			var c = document.getElementsByTagName('canvas')[0];
			var a = c.getContext('2d');
			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218
		</script>
		<script>
		c.style.cursor = 'none';
		b.style.margin = 0;

		var
			//Set width and height of canvas
			s = c.width = c.height = 500,

			//Get image data
			g = a.getImageData(0, 0, s, s),

			//Get image data data
			d = g.data,

			//Square of size
			m = s*s,

			//Used inside loop
			x, y,

			//Some foo for saving bytes in large formulas
			f,

			//Heart object (see: http://www.mathematische-basteleien.de/heart.htm)
			//TODO: possible optimization: array instead of object
			h = {
				//Radius of a single circle
				r: 20,

				//Square of radius
				s: 400,

				//Side length of square standing on it's point
				l: 57,

				//Center x (where the two circles meet)
				x: 100,

				//Center y (where the two circles meet)
				y: 100
			};

			setInterval(function(i) {
				for(; i < m; i++) {
					x = (i%s);
					y = (i/s)|0;

					if(
						//Square standing on it's point
						( x <= h.x && x >= h.x - h.r*2 && (h.x - h.r*2 - x)/(h.y - y) > 1) ||

						( x >= h.x && x <= h.x + h.r*2 && (h.x + h.r*2 - x)/(y - h.y) > 1) ||

						//Left circle
						(f=x-h.x-h.r)*f + (f=y-h.y-h.r)*f <= h.s ||

						//Right circle
						(f=x-h.x+h.r)*f + (f=y-h.y-h.r)*f <= h.s
					) {
						d[i*4] = d[i*4+3] = 255;
					} else {
						d[i*4] = d[i*4+3] = 0;
					}


					//Multiply 255 with true/false to make it red/white
					//d[i*4] = d[i*4+3] = 255 * ((x-h.x)*(x-h.x) + (y-h.y)*(y-h.y) < h.s) + 9;
				}

				a.putImageData(g, 0, 0);
			}, 33, 0);

			c.onmousemove = function(e) {
				return;
				h.x = e.clientX;
				h.y = e.clientY;
			}
		</script>
	</body>
</html>
